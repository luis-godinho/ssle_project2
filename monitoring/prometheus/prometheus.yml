# Prometheus configuration for E-commerce Platform

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: "ecommerce-cluster"
    environment: "production"

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets:
            - alertmanager:9093

# Load alert rules
rule_files:
  - "/etc/prometheus/alerts.yml"

# Scrape configurations
scrape_configs:
  # Node exporter for system metrics
  - job_name: "node-exporter"
    static_configs:
      - targets: ["node-exporter:9100"]
        labels:
          instance: "ecommerce-host"

  # Service Registry
  - job_name: "service-registry"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["registry:5000"]
        labels:
          service: "registry"
          tier: "infrastructure"

  # Product Service
  - job_name: "product-service"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["product-service:8001"]
        labels:
          service: "product-service"
          tier: "backend"

  # Order Service
  - job_name: "order-service"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["order-service:8002"]
        labels:
          service: "order-service"
          tier: "backend"

  # Payment Service
  - job_name: "payment-service"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["payment-service:8003"]
        labels:
          service: "payment-service"
          tier: "backend"

  # API Gateway (DoS Protection)
  - job_name: "api-gateway"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["api-gateway:8080"]
        labels:
          service: "api-gateway"
          tier: "gateway"
          threat: "dos"

